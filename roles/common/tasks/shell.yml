---
- include_vars: "{{ item }}"
  with_first_found:                                   
    - "../vars/{{ ansible_distribution | lower }}-{{ ansible_distribution_major_version | int}}.yml"
    - "../vars/{{ ansible_distribution | lower }}-{{ ansible_distribution_release | lower}}.yml"
    - "../vars/{{ ansible_distribution | lower }}.yml"
    - "../vars/{{ ansible_os_family | lower }}.yml"
    - "../vars/default.yml"

- name: install shell terminal packages
  become: yes
  package: 
    name:
      - "{{ zsh }}"
      - "{{ guake }}"
      - "{{ libutempter }}"
    state: latest

- name: install oh-my-zsh
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh"

- name: Create a new zsh config from the template in the repo
  command: "cp {{ ansible_env.HOME }}/.oh-my-zsh/templates/zshrc.zsh-template {{ ansible_env.HOME }}/.zshrc"

- name: Set zsh as default shell
  user: 
    name: "{{ ansible_env.USER }}"
    shell: /usr/bin/zsh
  become: yes

- name: Clone powerline repo
  git:
    repo: https://github.com/powerline/fonts.git
    depth: 1
    dest: /tmp/powerline

- name: install powerline from source
  shell: >
    /bin/bash -c "cd /tmp/powerline && ./install.sh && cd /tmp && rm -rf powerline"
  
